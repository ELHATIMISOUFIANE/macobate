---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import AppointmentForm from "../../components/AppointmentForm.astro";
import CallToActionSection from "../../components/CallToActionSection.astro";

const projects = [
  {
    id: "dams-hydraulic-infrastructure",
    title: "Dams & Hydraulic Infrastructure",
    category: "Infrastructure Hydraulique",
    description: `
      <p>MACOBATE is one of the leading players in hydraulic engineering in Morocco. Our expertise covers the design, manufacturing and installation of hydromechanical equipment for dams, hydroelectric plants and hydraulic infrastructure.</p>
      
      <p>Our expertise includes:</p>
      <ul>
        <li><strong>Gates of all types</strong>: radial, sluice, butterfly</li>
        <li><strong>Penstocks</strong> and steel linings</li>
        <li><strong>Intake screens and trash racks</strong></li>
        <li><strong>Lifting and control systems</strong></li>
      </ul>
      
      <p>Major projects completed:</p>
      <ol>
        <li><strong>Oued El Makhazine Dam</strong>: Complete hydromechanical equipment for spillway</li>
        <li><strong>Al Massira Dam</strong>: Renovation of radial gates and control systems</li>
        <li><strong>Lalla Takerkoust Dam</strong>: Installation of penstocks and bifurcations</li>
        <li><strong>Sidi Mohamed Ben Abdellah Dam</strong>: Gates and regulation equipment</li>
      </ol>
      
      <p>Each project is carried out according to the highest quality standards, with rigorous testing and particular attention to durability under demanding operating conditions. We also provide maintenance and rehabilitation of existing equipment to extend their service life.</p>
    `,
    image: "/images/projects/barrages-hydrauliques.jpg",
    features: [
      "Over 30 dams equipped in Morocco",
      "Complete expertise from component to integrated system",
      "Ability to intervene in difficult conditions",
      "Tailor-made solutions for each project",
      "Preventive maintenance and rehabilitation",
    ],
    client: "Ministry of Equipment and Water, ONEE",
    location: "Several regions of Morocco",
    year: "1980-present",
  },
  {
    id: "pumping-treatment-stations",
    title: "Pumping & Treatment Stations",
     category: "Traitement d'Eau",
    description: `
      <p>MACOBATE designs and builds complete water pumping and treatment stations, from studies to commissioning. Our integrated approach combines mechanical, hydraulic, electrical and automation expertise to deliver efficient and sustainable solutions.</p>
      
      <p>Our achievements include:</p>
      <ul>
        <li><strong>Potable water pumping stations</strong> from small to large capacity</li>
        <li><strong>Conventional and modular water treatment plants</strong></li>
        <li><strong>Wastewater treatment plants</strong></li>
        <li><strong>Reverse osmosis desalination plants</strong></li>
      </ul>
      
      <p>Reference projects:</p>
      <ol>
        <li><strong>SP2 Pumping Station - Agadir</strong>: Design and construction of a 1000 l/s potable water pumping station with complete electromechanical equipment</li>
        <li><strong>Bouskoura Treatment Plant</strong>: Installation of a 100 l/s MWS modular station for potable water</li>
        <li><strong>Skhirat-Témara Pumping Station</strong>: Hydromechanical and electrical equipment for 500 l/s station</li>
        <li><strong>El Jadida Wastewater Treatment Plant</strong>: Supply and installation of mechanical and electrical equipment</li>
      </ol>
      
      <p>Our stations are distinguished by their reliability, energy efficiency and ease of operation. We integrate advanced automation and remote control technologies, enabling optimal supervision and preventive maintenance.</p>
    `,
    image: "/images/projects/stations-pompage-traitement.jpg",
    features: [
      "Optimized hydraulic design",
      "Local manufacturing of mechanical equipment",
      "Turnkey solutions up to commissioning",
      "Intelligent control systems",
      "Energy efficiency and sustainability",
    ],
    client: "ONEE, Autonomous Agencies, Territorial Communities",
    location: "National & International",
    year: "1990-present",
  },
  {
    id: "industrial-infrastructure",
    title: "Industrial Infrastructure",
    category: "Industrie",
    description: `
      <p>MACOBATE develops complex industrial projects for various strategic sectors. Our expertise in steel construction, pressure equipment and process integration enables us to realize complete and efficient industrial infrastructure.</p>
      
      <p>Our offering covers:</p>
      <ul>
        <li><strong>Industrial buildings</strong> and steel structures</li>
        <li><strong>Storage tanks and silos</strong></li>
        <li><strong>Process units</strong> and special equipment</li>
        <li><strong>Industrial piping</strong> and complex networks</li>
      </ul>
      
      <p>Major achievements:</p>
      <ol>
        <li><strong>Jorf Lasfar Phosphate Plant</strong>: Construction of steel structures, pipe racks and process equipment</li>
        <li><strong>Tanger Med Port Terminal</strong>: Steel structures and storage tanks</li>
        <li><strong>Agadir Desalination Unit</strong>: Manufacturing and installation of pressure tanks and piping systems</li>
        <li><strong>Settat Cement Plant</strong>: Steel silos and conveyor structures</li>
      </ol>
      
      <p>Our commitment to quality and safety is at the heart of every project. We operate in demanding industrial environments with high manufacturing and installation standards, ensuring compliance with international standards and the sustainability of installations.</p>
    `,
    image: "/images/projects/infrastructures-industrielles.jpeg",
    features: [
      "Multi-trade integration: mechanical, electrical, process",
      "Expertise in ATEX environments and severe conditions",
      "Certified manufacturing ISO 9001, EN 1090, ASME",
      "Energy optimization solutions",
      "Strict adherence to industrial schedules",
    ],
    client: "OCP, ONEE, Private Industries",
    location: "Morocco & Export",
    year: "1985-present",
  },
  {
    id: "renewable-energy",
    title: "Renewable Energy",
     category: "Énergie",
    description: `
      <p>MACOBATE is committed to the energy transition by developing renewable energy projects adapted to specific client needs. Our technical expertise enables us to integrate sustainable energy solutions into industrial and infrastructure projects.</p>
      
      <p>Our intervention areas include:</p>
      <ul>
        <li><strong>Autonomous and hybrid solar pumping systems</strong></li>
        <li><strong>Hybrid energy stations</strong> (solar-diesel) for remote sites</li>
        <li><strong>Equipment for small hydroelectric plants</strong></li>
        <li><strong>Energy efficiency solutions</strong> for industrial installations</li>
      </ul>
      
      <p>Representative projects:</p>
      <ol>
        <li><strong>Taroudant Solar Pumping Station</strong>: Installation of solar-powered pumps for irrigation, 50 kWp capacity</li>
        <li><strong>Hybrid system for Dakhla water treatment station</strong>: Integration of 100 kWp solar with diesel backup</li>
        <li><strong>Ifrane Micro-hydroelectric plant</strong>: Hydromechanical equipment for energy valorization</li>
        <li><strong>Tafilalet Rural electrification project</strong>: Autonomous systems for isolated villages</li>
      </ol>
      
      <p>Our approach aims to maximize our clients' energy autonomy while reducing their carbon footprint. We design robust systems, adapted to local conditions and easy to maintain, with a particular focus on skills transfer to operating teams.</p>
    `,
    image: "/images/projects/energie-renouvelable.jpg",
    features: [
      "Custom energy solutions",
      "Optimized integration into existing processes",
      "Production monitoring and optimization systems",
      "Total cost of ownership (TCO) approach",
      "Expertise in remote sites and difficult climatic conditions",
    ],
    client: "ONEE, MASEN, Communities, Private Sector",
    location: "Morocco & Sub-Saharan Africa",
    year: "2010-present",
  },
  {
    id: "export-africa-projects",
    title: "Export & Africa Projects",
    category: "International",
    description: `
      <p>MACOBATE exports its Moroccan expertise across Africa, bringing solutions adapted to the continent's specific challenges. Our multidisciplinary expertise enables us to carry out complete projects in complex environments and remote areas.</p>
      
      <p>Our export offering includes:</p>
      <ul>
        <li><strong>Mobile water treatment stations</strong> MWS adapted to African contexts</li>
        <li><strong>Hydromechanical equipment</strong> for dams and hydraulic structures</li>
        <li><strong>Autonomous energy solutions</strong> for unconnected areas</li>
        <li><strong>Industrial infrastructure</strong> and process equipment</li>
      </ul>
      
      <p>Emblematic projects:</p>
      <ol>
        <li><strong>Bamako Water Treatment Station (Mali)</strong>: Supply and installation of MWS modular stations for potable water</li>
        <li><strong>Hydromechanical Equipment - Kandadji Dam (Niger)</strong>: Gates and control devices</li>
        <li><strong>Mauritania Desalination Units</strong>: Water treatment solutions for coastal areas</li>
        <li><strong>Senegal Solar Pumping Systems</strong>: Installations for rural villages</li>
      </ol>
      
      <p>Our African approach is distinguished by adaptation to local realities: robust design for difficult environments, ease of maintenance, thorough training of local teams and responsive after-sales service. We actively contribute to technology transfer and local skills development.</p>
    `,
    image: "/images/projects/station-eau-kabala-mali.jpg",
    features: [
      "Solutions adapted to African contexts",
      "Mobile intervention teams for all of Africa",
      "Thorough training of local operators",
      "Mastered international logistics",
      "Respect for international standards in local context",
    ],
    client:
      "African Governments, Development Agencies, Local Companies",
    location: "West and Central Africa",
    year: "2000-present",
  },
  {
    id: "marine-equipment",
    title: "Marine Equipment",
    category: "Maritime",
    description: `
      <p>MACOBATE designs and manufactures specialized equipment for port and marine infrastructure. Our expertise in metalwork in marine environments enables us to provide sustainable solutions adapted to demanding coastal conditions.</p>
      
      <p>Our product range includes:</p>
      <ul>
        <li><strong>Port steel structures</strong> and equipment supports</li>
        <li><strong>Submarine pipes and sea outfalls</strong> in protected steel</li>
        <li><strong>Marine hydraulic gates and equipment</strong></li>
        <li><strong>Desalination systems for coastal areas</strong></li>
      </ul>
      
      <p>Significant projects:</p>
      <ol>
        <li><strong>Port of Casablanca</strong>: Manufacturing and installation of special steel structures</li>
        <li><strong>Tanger Marine Outfall</strong>: Pipes and protection equipment</li>
        <li><strong>Jorf Lasfar Seawater Intake System</strong>: Hydromechanical equipment and structures</li>
        <li><strong>Nador West Med Port Terminal</strong>: Specialized steel components</li>
      </ol>
      
      <p>Our marine equipment is designed with particular attention to corrosion resistance, using suitable materials (duplex stainless steel, special coatings) and advanced cathodic protection techniques. We ensure exceptional durability even in the most aggressive environments.</p>
    `,
    image: "/images/projects/equipements-maritimes.jpg",
    features: [
      "Expertise in marine corrosion and protection",
      "Specific design for coastal conditions",
      "Use of special steels and resistant alloys",
      "International marine certifications",
      "Specialized teams for port interventions",
    ],
    client: "ANP, Ministry of Equipment, Port Operators",
    location: "Coastal areas of Morocco",
    year: "1995-present",
  },
  {
    id: "industry-process",
    title: "Industry & Process",
    category: "Process",
    description: `
      <p>MACOBATE develops complete industrial solutions including the design and realization of custom process equipment. Our multidisciplinary expertise enables us to intervene in various sectors requiring specific and efficient equipment.</p>
      
      <p>Our industrial offering includes:</p>
      <ul>
        <li><strong>Process reactors and vessels</strong> in different materials</li>
        <li><strong>Heat exchangers</strong> and heat transfer equipment</li>
        <li><strong>Integrated process skids</strong> and modular units</li>
        <li><strong>Industrial filtration and separation systems</strong></li>
      </ul>
      
      <p>Outstanding industrial achievements:</p>
      <ol>
        <li><strong>OCP Phosphoric Acid Treatment Unit</strong>: Manufacturing of special reactors and exchangers</li>
        <li><strong>Process skids for food industry Marrakech</strong>: Stainless steel units with automation</li>
        <li><strong>Chemical industry equipment Mohammedia</strong>: Manufacturing of pressure vessels and reactors</li>
        <li><strong>Industrial filtration systems Tanger</strong>: Complete units for free zone</li>
      </ol>
      
      <p>Our strength lies in our ability to integrate process design, mechanical manufacturing and automation into turnkey industrial solutions. We guarantee compliance with sector standards (pharmaceutical, food, chemical) and complete traceability of our manufacturing.</p>
    `,
    image: "/images/projects/industrie-process.jpg",
    features: [
      "Mastery of complex industrial processes",
      "Local manufacturing capacity for special equipment",
      "Expertise in specific materials (stainless steel, duplex, alloys)",
      "Integrated automation and control systems",
      "Complete technical documentation and performance validation",
    ],
    client: "Diversified industrial sectors (chemical, agri-food, mining)",
    location: "Morocco & International",
    year: "1985-present",
  },
];

// Project IDs list for verification
const projectIds = projects.map((project) => project.id);
---

<BaseLayout title="Our Projects - MACOBATE">
  <Header />
  <main>
    <!-- Page Title -->
    <section
      class="page-title"
      style="background-image:url(/images/background/6.jpg);
      filter: brightness(1.5)"
    >
      <div class="auto-container">
        <ul class="page-breadcrumb" aria-label="Breadcrumb">
          <li><a href="/">Home</a></li>
          <li><a href="/projects/allProjects">Projects</a></li>
          <li>Our Projects</li>
        </ul>
        <h1>Our Projects</h1>
      </div>
    </section>

    <!-- Projects Section -->
    <section class="projects-detail-section">
      <div class="auto-container">
        <div class="row clearfix">
          <!-- Sidebar Projects Menu -->
          <div class="sidebar-column col-lg-3 col-md-4 col-sm-12">
            <div class="inner-column">
              <div class="projects-list">
                <h3>All our projects</h3>
                <ul aria-label="Projects list">
                  {
                    projects.map((project) => (
                      <li id={`menu-item-${project.id}`}>
                        <a
                          href={`#${project.id}`}
                          class="project-link"
                          data-project-id={project.id}
                        >
                          {project.title}
                        </a>
                      </li>
                    ))
                  }
                </ul>
              </div>

              <!-- <div class="help-box">
                <h4>Need assistance?</h4>
                <p>
                  Our sales team is available to study your project.
                </p>
                <a
                  href="/formDevis"
                  class="theme-btn btn-style-one"
                
                >
                  Request a quote <span
                    class="icon flaticon-arrow-pointing-to-right"></span>
                </a>
              </div> -->
            </div>
          </div>

          <!-- Project Content Column -->
          <div class="content-column col-lg-9 col-md-8 col-sm-12">
            <div class="inner-column">
              {
                projects.map((project, index) => (
                  <div id={project.id} class="project-detail">
                    <div class="project-header">
                      <h2 class="project-title">{project.title}</h2>
                      <div class="project-meta">
                        <div class="meta-item">
                          <span class="label">Client:</span>
                          <span class="value">{project.client}</span>
                        </div>
                        <div class="meta-item">
                          <span class="label">Location:</span>
                          <span class="value">{project.location}</span>
                        </div>
                        <div class="meta-item">
                          <span class="label">Year:</span>
                          <span class="value">{project.year}</span>
                        </div>
                      </div>
                      <div class="separator" />
                    </div>

                    <div class="project-image">
                      <img
                        src={project.image}
                        alt={`Illustration of ${project.title} project`}
                        class="img-fluid"
                      />
                    </div>

                    <div class="text-content" set:html={project.description} />

                    <div class="features-box">
                      <h3>Project highlights</h3>
                      <div class="features-list">
                        {project.features.map((feature) => (
                          <div class="feature-item">
                            <span
                              class="icon flaticon-tick"
                              aria-hidden="true"
                            />
                            <span class="feature-text">{feature}</span>
                          </div>
                        ))}
                      </div>
                    </div>

                    <div class="action-box">
                      <a
                        href="/formDevis"
                        class="theme-btn btn-style-one"
                       
                      >
                        Discuss a similar project
                        <span
                          class="icon flaticon-arrow-pointing-to-right"
                          aria-hidden="true"
                        />
                      </a>
                    </div>
                  </div>
                ))
              }
            </div>
          </div>
        </div>
      </div>
    </section>

    <CallToActionSection />
    <AppointmentForm />
  </main>
  <Footer />
</BaseLayout>

<style>
  html {
    scroll-behavior: smooth;
  }

  /* Styles for project detail section */
  .projects-detail-section {
    padding: 80px 0;
    background-color: #f8f9fa;
  }

  /* Styles for projects list in sidebar */
  .projects-list {
    background-color: white;
    border-radius: 6px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    padding: 25px;
    margin-bottom: 30px;
  }

  .projects-list h3 {
    font-size: 20px;
    margin-bottom: 20px;
    border-bottom: 1px solid #e9ecef;
    padding-bottom: 15px;
    color: #333;
  }

  .projects-list ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .projects-list ul li {
    margin-bottom: 10px;
    border-bottom: 1px solid #f1f1f1;
    transition: all 0.3s ease;
  }

  .projects-list ul li:last-child {
    border-bottom: none;
    margin-bottom: 0;
  }

  .projects-list ul li a {
    padding: 10px 0;
    display: block;
    color: #555;
    font-size: 15px;
    transition: all 0.3s ease;
    position: relative;
    padding-left: 15px;
  }

  .projects-list ul li a:before {
    content: "\f105";
    font-family: "FontAwesome";
    position: absolute;
    left: 0;
    top: 10px;
    color: #1720d7;
  }

  .projects-list ul li a.active,
  .projects-list ul li a:hover {
    color: #1720d7;
    font-weight: 600;
  }

  /* Enhanced style for active link */
  .projects-list ul li a.active {
    color: #1720d7;
    font-weight: 700;
    background-color: rgba(23, 32, 215, 0.05);
    display: block;
    border-radius: 4px;
    padding-left: 15px;
  }

  .projects-list ul li a.active:before {
    color: #1720d7;
    font-weight: bold;
  }

  /* Help box */
  .help-box {
    background-color: #1720d7;
    color: white;
    border-radius: 6px;
    padding: 30px;
    text-align: center;
  }

  .help-box h4 {
    font-size: 22px;
    margin-bottom: 15px;
    color: white;
  }

  .help-box p {
    margin-bottom: 20px;
    color: rgba(255, 255, 255, 0.9);
  }

  .help-box .theme-btn {
    background-color: white;
    color: #1720d7;
  }

  /* Project content */
  .project-detail {
    background-color: white;
    border-radius: 6px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    padding: 30px;
    margin-bottom: 30px;
    display: none; /* All projects are hidden by default */
  }

  .project-detail.active {
    display: block; /* Only the active project is displayed */
  }

  .project-header {
    margin-bottom: 30px;
  }

  .project-meta {
    display: flex;
    flex-wrap: wrap;
    margin-top: 15px;
    margin-bottom: 20px;
    background-color: #f8f9fa;
    border-radius: 4px;
    padding: 15px;
  }

  .meta-item {
    margin-right: 30px;
    margin-bottom: 5px;
  }

  .meta-item .label {
    font-weight: 600;
    color: #333;
    margin-right: 5px;
  }

  .meta-item .value {
    color: #555;
  }

  .project-image {
    margin-bottom: 30px;
    border-radius: 6px;
    overflow: hidden;
    width: 100%;
    aspect-ratio: 16 / 9; /* Choose your ratio (e.g.: 16:9, 4:3, 1:1, etc.) */
    background-color: #eee; /* Optional: background color during loading */
  }

  .project-image img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* or 'contain' if you want to show everything without crop */
    display: block;
  }

  .text-content {
    margin-bottom: 30px;
    color: #555;
    line-height: 1.7;
  }

  .text-content p {
    margin-bottom: 20px;
  }

  .text-content ul,
  .text-content ol {
    margin-bottom: 20px;
    padding-left: 20px;
  }

  .text-content li {
    margin-bottom: 10px;
  }

  .text-content strong {
    color: #333;
    font-weight: 600;
  }

  /* Project highlights */
  .features-box {
    background-color: #f8f9fa;
    border-radius: 6px;
    padding: 25px;
    margin-bottom: 30px;
  }

  .features-box h3 {
    font-size: 18px;
    margin-bottom: 20px;
    color: #333;
  }

  .features-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 15px;
  }

  .feature-item {
    display: flex;
    align-items: center;
    padding: 10px;
    background-color: white;
    border-radius: 4px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  }

  .feature-item .icon {
    color: #1720d7;
    margin-right: 10px;
    font-size: 16px;
  }

  .feature-text {
    font-size: 14px;
    color: #333;
  }

  /* Action box */
  .action-box {
    text-align: center;
    margin-top: 30px;
  }

  /* Responsive */
  @media (max-width: 991px) {
    .project-detail {
      padding: 20px;
    }

    .features-list {
      grid-template-columns: 1fr;
    }

    .project-meta {
      flex-direction: column;
    }

    .meta-item {
      margin-right: 0;
      margin-bottom: 10px;
    }
  }
</style>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const links = document.querySelectorAll(".project-link");
    const sections = document.querySelectorAll(".project-detail");

    // Function to display a specific project
    function showProject(id) {
      // Check if ID exists
      const targetElement = document.getElementById(id);
      if (!targetElement) {
        console.warn(`Project with ID ${id} not found`);
        // Display the first project by default if the requested ID doesn't exist
        if (sections.length > 0) {
          const defaultId = sections[0].id;
          showProject(defaultId);
        }
        return;
      }

      // Hide all projects
      sections.forEach((section) => {
        section.classList.remove("active");
        section.style.display = "none";
      });

      // Show the requested project
      targetElement.classList.add("active");
      targetElement.style.display = "block";

      // Update active state of links
      links.forEach((link) => {
        link.classList.remove("active");
        // Get parent element (li)
        const parentLi = link.parentElement;
        parentLi.classList.remove("active-item");

        // Check if it's the active link
        const linkId = link.getAttribute("data-project-id");
        if (linkId === id) {
          link.classList.add("active");
          parentLi.classList.add("active-item");
        }
      });

      // Update URL without reloading page
      history.pushState(null, "", `#${id}`);

      // Update main menu links if present
      try {
        // Look for main menu links
        const mainMenuLinks = document.querySelectorAll(
          ".main-menu .navigation a"
        );
        mainMenuLinks.forEach((menuLink) => {
          const href = menuLink.getAttribute("href");
          if (href && href.includes(id)) {
            // Find the closest parent element with dropdown class
            let parentLi = menuLink.closest("li");

            // Add active class
            if (parentLi) {
              // First reset all links
              document
                .querySelectorAll(".main-menu .navigation li")
                .forEach((li) => {
                  if (li !== parentLi && !li.contains(parentLi)) {
                    li.classList.remove("current");
                  }
                });

              // Then add active class
              parentLi.classList.add("current");

              // If the link is in a submenu, also add class to parent
              const parentDropdown = parentLi.closest(".dropdown");
              if (parentDropdown) {
                parentDropdown.classList.add("current");
              }
            }
          }
        });
      } catch (e) {
        console.warn("Navigation menu links not found or error occurred", e);
      }
    }

    // Add event listeners to links
    links.forEach((link) => {
      link.addEventListener("click", function (e) {
        e.preventDefault();
        const id = this.getAttribute("data-project-id");
        showProject(id);
      });
    });

    // Handle hash changes in URL
    window.addEventListener("hashchange", function () {
      const hash = window.location.hash.substring(1);
      if (hash) {
        showProject(hash);
      }
    });

    // Initialization: show project corresponding to hash or first project
    const hash = window.location.hash.substring(1);
    if (hash) {
      showProject(hash);
    } else if (sections.length > 0) {
      showProject(sections[0].id);
    }

    // Enhancement: update header links if matching with projects
    function updateHeaderLinks() {
      const currentHash = window.location.hash.substring(1);
      if (!currentHash) return;

      try {
        // Find all main menu links that can contain project IDs
        const headerMenuLinks = document.querySelectorAll(
          ".main-menu .navigation a"
        );

        headerMenuLinks.forEach((link) => {
          const href = link.getAttribute("href");
          if (href && href.includes(currentHash)) {
            // Add 'current' class to parent li element
            const parentLi = link.closest("li");
            if (parentLi) {
              parentLi.classList.add("current");

              // If parent is in a dropdown, also mark the dropdown
              const parentDropdown = parentLi.closest(".dropdown");
              if (parentDropdown && parentDropdown !== parentLi) {
                parentDropdown.classList.add("current");
              }
            }
          }
        });
      } catch (e) {
        console.warn("Error updating header links", e);
      }
    }

    // Call this function on initial load
    updateHeaderLinks();

    // Test if header exists and contains expected elements
    const header = document.querySelector(".main-header");
    if (header) {
      console.log("Header found, menu synchronization enabled");
    }
  });
</script>